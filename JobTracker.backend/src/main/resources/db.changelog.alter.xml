<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">


	<changeSet id="20160509-CREATEPseudoJob" author="phil">
		<sql>
			<![CDATA[
				DROP TABLE IF EXISTS `pseudo_job`;
				CREATE TABLE `pseudo_job`
				(
					`id` INT NOT NULL AUTO_INCREMENT,
					`name` VARCHAR(30),
					`customer` VARCHAR(30),
					PRIMARY KEY (`id`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-CREATECustomer" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `customer`
				(
					`id` INT NOT NULL AUTO_INCREMENT,
					`name` VARCHAR(30),
					PRIMARY KEY (`id`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-ALTERJob" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `job`
				(
					`job_no` INT NOT NULL AUTO_INCREMENT,
					`pos_no` INT NOT NULL,
					`description` VARCHAR(30) NOT NULL,
					`customer_id` INT,
					`budget` DECIMAL(13,4),
					`budget_used` DECIMAL(13,4),
					`accounting_mode` INT,
					`is_intern` BOOLEAN,
					PRIMARY KEY (`job_no`,`pos_no`,`description`),
					FOREIGN KEY (`customer_id`) REFERENCES customer(`id`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-CREATEUser-DROPEmployee" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `user`
				(
					`id` INT NOT NULL AUTO_INCREMENT,
					`name` VARCHAR(30),
					`surname` VARCHAR(30),
					`supervisor` INT,
					PRIMARY KEY (`id`),
					FOREIGN KEY (`supervisor`) REFERENCES user(`id`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-CREATEJob_Task" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `job_task`
				(
					`id` INT NOT NULL AUTO_INCREMENT,
					`job_id` INT NOT NULL,
					`name` VARCHAR(30),
					PRIMARY KEY (`id`,`job_id`),
					FOREIGN KEY (`job_id`) REFERENCES job(`job_no`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-CREATEUserJob" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `user_job`
				(
					`user_id` INT NOT NULL AUTO_INCREMENT,
					`job_id` INT,
					`role` INT,
					PRIMARY KEY (`user_id`,`job_id`),
					FOREIGN KEY (`user_id`) REFERENCES user(`id`),
					FOREIGN KEY (`job_id`) REFERENCES job(`job_no`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-CREATEActivityReportTemplate" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `activity_report_template`
				(
					`id` INT NOT NULL AUTO_INCREMENT,
					`author` INT NOT NULL,
					`text` VARCHAR(30),
					`task_id` INT,
					PRIMARY KEY (`id`,`author`),
					FOREIGN KEY (`task_id`) REFERENCES job_task(`id`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-CREATEUtilizationWeek" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `UTILIZATION_WEEK`
				(
					`id` INT NOT NULL AUTO_INCREMENT,
					`author` INT NOT NULL,
					`begin` DATE,
					`days_free` INT,
					`days_work` INT,
					`days_holiday` INT,
					`possibility` INT,
					`pseudo_job_id` INT,
					PRIMARY KEY (`id`,`author`),
					FOREIGN KEY (`author`) REFERENCES user(`id`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
	<changeSet id="20160509-ALTERActivityReport" author="phil">
		<sql>
			<![CDATA[
				CREATE TABLE `ACTIVITY_REPORT`
				(
					`id` INT NOT NULL AUTO_INCREMENT,
					`author` INT NOT NULL,
					`text` VARCHAR(30),
					`begin_date` DATE,
					`begin_time` TIME,
					`end_date` DATE,
					`end_time` TIME,
					`task_id` INT,
					`job_no` INT,
					`pos_no` INT,
					PRIMARY KEY (`id`,`author`),
					FOREIGN KEY (`task_id`) REFERENCES job_task(`id`),
					FOREIGN KEY (`job_no`, `pos_no`) REFERENCES job(`job_no`, `pos_no`)
				)
				ENGINE = InnoDB
				;
			]]>
		</sql>
	</changeSet>
</databaseChangeLog>